<link rel="stylesheet" href="/css/edit-review.css">
<div class="setting">
  <div class="dropdown">
    <button class="edit-button" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
      <img src="/image/setting.png" alt="Setting" />
    </button>

    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
      <a class="dropdown-item edit-review-link" href="#" data-review-id="<%= review._id.toString() %>">Edit this
        review</a>
      <a class="dropdown-item delete-review-link" href="#" data-review-id="<%= review._id.toString() %>">Delete this
        review</a>

    </div>
  </div>
</div>

<!-- Add a modal container -->
<div id="deleteReviewModal" class="modal">
  <div class="modal-content">
    <h2 class="modal-header">Confirm Delete</h2>
    <p>Are you sure you want to delete this review?</p>
    <div class="modal-buttons">
      <button id="confirmDeleteBtn" class="btn-confirm">Delete</button>
      <button id="cancelDeleteBtn" class="btn-cancel">Cancel</button>
    </div>
  </div>
</div>



<script>
  $(document).ready(function () {
    $(document).on('click', '.edit-review-link', function (e) {
      e.preventDefault();

      const reviewId = $(this).data('review-id');

      // Redirect to the edit review page with the review ID
      window.location.href = '/reviews/write/updateReview/' + reviewId;
    });
  });

  $(document).ready(function () {
    // Handle delete review link click
    $(document).on('click', '.delete-review-link', function (e) {
      e.preventDefault();

      const reviewId = $(this).data('review-id');

      // Show the custom modal
      $('#deleteReviewModal').css('display', 'block');

      //delete button clicked and delete the review from the database
      $('#confirmDeleteBtn').on('click', function () {
        // Send a delete request to the server
        $.ajax({
          url: '/reviews/deleteReview/' + reviewId,
          type: 'DELETE',
          success: function (result) {
            // Handle success response
            console.log('Review deleted successfully');
            // You can perform any additional actions here, such as updating the UI or reloading the reviews list
          },
          error: function (error) {
            // Handle error response
            console.error('Failed to delete review:', error);
          }
        });

        // Hide the modal
        $('#deleteReviewModal').css('display', 'none');
      });

      // cancel button clicked and hide the modal
      $('#cancelDeleteBtn').on('click', function () {
        $('#deleteReviewModal').css('display', 'none');
      });
    });
  });



</script>