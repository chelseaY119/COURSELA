<% if (isLoggedIn) { %>
  <%- include("templates/header") %>
<% } else { %>
  <%- include("templates/header-beforeLogin") %>
<% } %>

<!--Course Detail-->
<div class="course-detail">
  <div class="course-detail-buttons">
    <a target="_blank" href="<%= courseInfo.Course_URL %>" class="btn share-link">
      Link to the course
      <span class="material-symbols-outlined">
        exit_to_app
      </span>
    </a>
  </div>
  <h2>
    <%= courseInfo.Title %>
  </h2>
  <div class="course-detail-ratings">
    <div class="detail-rating-box">
      <p>
        <span class="rating-number">
          <%= typeof (courseInfo.Course_Rating)  == "number" ? courseInfo.Course_Rating.toFixed(1) : "N/A" %></span> /5
      </p>
      <strong>Provider Rating</strong>
    </div>
    <div class="detail-rating-box">
      <p>
        <span class="rating-number">Dev</span> /5
      </p>
      <strong>Coursla Rating</strong>
    </div>
  </div>
  <ul class="course-detail-overview">
    <li class="provider">
        <div class="content">
          <% if (courseInfo.Provider?.toLowerCase() == 'udemy') { %>
            <img src="/image/logo-udemy.svg" alt="Udemy">
          <% }%>
          <% if (courseInfo.Provider?.toLowerCase() == 'coursera') { %>
            <img src="/image/logo-coursera.svg" alt="Coursera">
          <% }%>
        </div>
        <span class="title">Provider</span>
    </li>
    <li class="provider">
      <div class="content">
        <span class="level-label">
          <%= courseInfo.Course_Difficulty %>
        </span>
      </div>
      <span class="title">Level</span>
    </li>

      <li class="enrollment">
        <div class="content">
          Dev
        </div>
        <span class="title">Enrollment</span>
      </li>
  </ul>
  <div class="course-detail-info">
    <dl>
      <dt>Instructor/Organization</dt>
      <dd><%= courseInfo.Organization %></dd>
    </dl>
    <dl>
      <dt>Description</dt>
      <dd><%= courseInfo.Course_Description %></dd>
    </dl>
  </div>
</div>




<!--Reviews-->

  <% let courseContentSum=0; %>
    <% let courseStructureSum=0; %>
      <% let teachingStyleSum=0; %>
        <% let studentSupportSum=0; %>
          <% let num=0; %>

            <!-- need to connect the course collection -->

            <div class="number-ratings" style="margin-top: 20%;font-size: 25px; font-weight: bold;">
              <%= reviewSliderPairs.length %> Student Ratings
            </div>

            <!-- add css later -->
            <a class="write-review-link" href="/reviews/write/:<%= courseId %>">
              <button>Write a Review</button>
            </a>

              <% reviewSliderPairs.forEach(pair=> { %>
                <%- include("read-review", { review: pair.review, sliderValue: pair.sliderValue, username: username, courseId: courseId })
                  %>
                  <% courseContentSum +=parseInt(pair.sliderValue.courseContentSliderValue); %>
                    <% courseStructureSum +=parseInt(pair.sliderValue.courseStructureSliderValue); %>
                      <% teachingStyleSum +=parseInt(pair.sliderValue.teachingStyleSliderValue); %>
                        <% studentSupportSum +=parseInt(pair.sliderValue.studentSupportSliderValue); %>
                          <% num ++; %>
                            <% }) %>
                              <%- include("all-reviews", { courseContentSum: courseContentSum, courseStructureSum:
                                courseStructureSum, teachingStyleSum: teachingStyleSum, studentSupportSum:
                                studentSupportSum, num: num }) %>
                           

                                  <%- include("templates/footer") %>